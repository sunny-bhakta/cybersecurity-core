#!/usr/bin/env python3
"""
Executive Summary Template Generator
Generates executive summary templates for penetration testing reports.
"""

import sys
from datetime import datetime
from typing import Dict

class ExecutiveSummaryTemplate:
    def __init__(self, client_name: str, project_name: str):
        self.client_name = client_name
        self.project_name = project_name
        self.date = datetime.now().strftime("%Y-%m-%d")
    
    def generate_template(self, stats: Dict = None) -> str:
        """Generate executive summary template"""
        if stats is None:
            stats = {
                'total_vulnerabilities': 0,
                'critical': 0,
                'high': 0,
                'medium': 0,
                'low': 0
            }
        
        template = f"""# Executive Summary

## Project Information

**Client**: {self.client_name}
**Project**: {self.project_name}
**Date**: {self.date}
**Assessment Type**: Penetration Test

## Overview

This executive summary provides a high-level overview of the security assessment conducted for {self.client_name}. The assessment identified security vulnerabilities and provides recommendations for remediation.

## Key Findings

### Vulnerability Summary

- **Total Vulnerabilities**: {stats['total_vulnerabilities']}
- **Critical**: {stats['critical']}
- **High**: {stats['high']}
- **Medium**: {stats['medium']}
- **Low**: {stats['low']}

### Risk Assessment

The overall risk level is determined based on the severity and number of vulnerabilities identified during the assessment.

## Business Impact

[Describe the business impact of identified vulnerabilities]

## Recommendations

1. **Immediate Actions**: Address critical and high severity vulnerabilities
2. **Short-term**: Implement security controls and monitoring
3. **Long-term**: Establish security program and regular assessments

## Conclusion

[Provide conclusion and next steps]

---
*This is a template. Replace placeholders with actual assessment data.*
"""
        return template
    
    def save_template(self, filename: str = None):
        """Save template to file"""
        if filename is None:
            filename = f"executive_summary_{self.client_name.replace(' ', '_')}.md"
        
        template = self.generate_template()
        
        with open(filename, 'w') as f:
            f.write(template)
        
        print(f"[+] Executive summary template saved to {filename}")
        return filename

def main():
    if len(sys.argv) < 3:
        print("Usage: python executive_summary_template.py <client_name> <project_name>")
        print("Example: python executive_summary_template.py 'Acme Corp' 'Web Application Assessment'")
        sys.exit(1)
    
    client_name = sys.argv[1]
    project_name = sys.argv[2]
    
    generator = ExecutiveSummaryTemplate(client_name, project_name)
    generator.save_template()
    
    print("[+] Executive summary template generated")

if __name__ == "__main__":
    main()

