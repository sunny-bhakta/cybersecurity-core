#!/usr/bin/env python3
"""
Risk Assessment Template Generator
Generates risk assessment templates for penetration testing reports.
"""

import sys
from typing import Dict, List

class RiskAssessmentTemplate:
    def __init__(self, client_name: str):
        self.client_name = client_name
        self.risks = []
    
    def add_risk(self, vulnerability: str, likelihood: str, impact: str, 
                 risk_level: str, cvss_score: float = None) -> Dict:
        """Add risk to assessment"""
        risk = {
            'vulnerability': vulnerability,
            'likelihood': likelihood,
            'impact': impact,
            'risk_level': risk_level,
            'cvss_score': cvss_score
        }
        self.risks.append(risk)
        return risk
    
    def generate_template(self) -> str:
        """Generate risk assessment template"""
        template = f"""# Risk Assessment

## Client Information

**Client**: {self.client_name}
**Assessment Date**: [Date]

## Risk Matrix

| Vulnerability | Likelihood | Impact | Risk Level | CVSS Score |
|--------------|------------|--------|------------|------------|
"""
        
        if self.risks:
            for risk in self.risks:
                template += f"| {risk['vulnerability']} | {risk['likelihood']} | {risk['impact']} | {risk['risk_level']} | {risk.get('cvss_score', 'N/A')} |\n"
        else:
            template += "| [Vulnerability Name] | [High/Medium/Low] | [High/Medium/Low] | [Critical/High/Medium/Low] | [CVSS Score] |\n"
        
        template += """
## Risk Levels

### Critical Risk
- **Likelihood**: High
- **Impact**: High
- **Description**: Immediate action required

### High Risk
- **Likelihood**: High/Medium
- **Impact**: High/Medium
- **Description**: Address within 30 days

### Medium Risk
- **Likelihood**: Medium
- **Impact**: Medium
- **Description**: Address within 90 days

### Low Risk
- **Likelihood**: Low
- **Impact**: Low
- **Description**: Address as part of regular maintenance

## Risk Summary

### Critical Risks
[Number] critical risks identified requiring immediate attention.

### High Risks
[Number] high risks identified requiring prompt remediation.

### Medium Risks
[Number] medium risks identified for planned remediation.

### Low Risks
[Number] low risks identified for future consideration.

## Recommendations

1. **Prioritize Critical and High Risks**: Address immediately
2. **Implement Security Controls**: Prevent future vulnerabilities
3. **Regular Assessments**: Conduct periodic security assessments
4. **Security Training**: Educate staff on security best practices

---
*This is a template. Replace placeholders with actual risk assessment data.*
"""
        return template
    
    def save_template(self, filename: str = None):
        """Save template to file"""
        if filename is None:
            filename = f"risk_assessment_{self.client_name.replace(' ', '_')}.md"
        
        template = self.generate_template()
        
        with open(filename, 'w') as f:
            f.write(template)
        
        print(f"[+] Risk assessment template saved to {filename}")
        return filename

def main():
    client_name = sys.argv[1] if len(sys.argv) > 1 else 'Client Name'
    
    generator = RiskAssessmentTemplate(client_name)
    generator.save_template()
    
    print("[+] Risk assessment template generated")

if __name__ == "__main__":
    main()

