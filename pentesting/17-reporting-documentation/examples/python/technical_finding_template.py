#!/usr/bin/env python3
"""
Technical Finding Template Generator
Generates technical finding templates for penetration testing reports.
"""

import sys
from typing import Dict

class TechnicalFindingTemplate:
    def __init__(self):
        self.template = None
    
    def generate_template(self, finding: Dict = None) -> str:
        """Generate technical finding template"""
        if finding is None:
            finding = {
                'id': 'VULN-001',
                'title': 'SQL Injection Vulnerability',
                'severity': 'High',
                'cvss_score': 8.5,
                'affected_systems': ['Web Application'],
                'description': 'The application is vulnerable to SQL injection...',
                'impact': 'An attacker could extract sensitive data...',
                'remediation': 'Use parameterized queries...',
                'references': ['OWASP Top 10', 'CWE-89']
            }
        
        template = f"""# Technical Finding: {finding['id']}

## Vulnerability Information

**Title**: {finding['title']}
**Severity**: {finding['severity']}
**CVSS Score**: {finding.get('cvss_score', 'N/A')}
**Affected Systems**: {', '.join(finding.get('affected_systems', []))}

## Description

{finding.get('description', '[Describe the vulnerability in detail]')}

## Impact

{finding.get('impact', '[Describe the business and technical impact]')}

## Proof of Concept

[Provide step-by-step proof of concept]

### Steps to Reproduce

1. [Step 1]
2. [Step 2]
3. [Step 3]

### Evidence

[Include screenshots, logs, or code snippets]

## Remediation

{finding.get('remediation', '[Provide detailed remediation steps]')}

### Immediate Actions

1. [Action 1]
2. [Action 2]

### Long-term Solutions

1. [Solution 1]
2. [Solution 2]

## References

{finding.get('references', ['OWASP', 'CWE'])}
"""
        return template
    
    def save_template(self, finding_id: str, filename: str = None):
        """Save template to file"""
        if filename is None:
            filename = f"technical_finding_{finding_id}.md"
        
        finding = {'id': finding_id}
        template = self.generate_template(finding)
        
        with open(filename, 'w') as f:
            f.write(template)
        
        print(f"[+] Technical finding template saved to {filename}")
        return filename

def main():
    finding_id = sys.argv[1] if len(sys.argv) > 1 else 'VULN-001'
    
    generator = TechnicalFindingTemplate()
    generator.save_template(finding_id)
    
    print("[+] Technical finding template generated")

if __name__ == "__main__":
    main()

