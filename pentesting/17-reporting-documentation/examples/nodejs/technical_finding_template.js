#!/usr/bin/env node
/**
 * Technical Finding Template Generator
 * Generates technical finding templates for penetration testing reports.
 */

const fs = require('fs');

class TechnicalFindingTemplate {
    constructor() {
        this.template = null;
    }

    generateTemplate(finding = null) {
        if (!finding) {
            finding = {
                id: 'VULN-001',
                title: 'SQL Injection Vulnerability',
                severity: 'High',
                cvssScore: 8.5,
                affectedSystems: ['Web Application'],
                description: 'The application is vulnerable to SQL injection...',
                impact: 'An attacker could extract sensitive data...',
                remediation: 'Use parameterized queries...',
                references: ['OWASP Top 10', 'CWE-89']
            };
        }
        
        return `# Technical Finding: ${finding.id}

## Vulnerability Information

**Title**: ${finding.title}
**Severity**: ${finding.severity}
**CVSS Score**: ${finding.cvssScore || 'N/A'}
**Affected Systems**: ${(finding.affectedSystems || []).join(', ')}

## Description

${finding.description || '[Describe the vulnerability in detail]'}

## Impact

${finding.impact || '[Describe the business and technical impact]'}

## Proof of Concept

[Provide step-by-step proof of concept]

### Steps to Reproduce

1. [Step 1]
2. [Step 2]
3. [Step 3]

### Evidence

[Include screenshots, logs, or code snippets]

## Remediation

${finding.remediation || '[Provide detailed remediation steps]'}

### Immediate Actions

1. [Action 1]
2. [Action 2]

### Long-term Solutions

1. [Solution 1]
2. [Solution 2]

## References

${(finding.references || ['OWASP', 'CWE']).join(', ')}
`;
    }

    saveTemplate(findingId, filename = null) {
        if (!filename) {
            filename = `technical_finding_${findingId}.md`;
        }
        
        const finding = { id: findingId };
        const template = this.generateTemplate(finding);
        
        fs.writeFileSync(filename, template, 'utf8');
        
        console.log(`[+] Technical finding template saved to ${filename}`);
        return filename;
    }
}

function main() {
    const findingId = process.argv[2] || 'VULN-001';
    
    const generator = new TechnicalFindingTemplate();
    generator.saveTemplate(findingId);
    
    console.log('[+] Technical finding template generated');
}

if (require.main === module) {
    main();
}

module.exports = TechnicalFindingTemplate;

