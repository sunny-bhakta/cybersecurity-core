#!/usr/bin/env node
/**
 * Risk Assessment Template Generator
 * Generates risk assessment templates for penetration testing reports.
 */

const fs = require('fs');

class RiskAssessmentTemplate {
    constructor(clientName) {
        this.clientName = clientName;
        this.risks = [];
    }

    addRisk(vulnerability, likelihood, impact, riskLevel, cvssScore = null) {
        const risk = {
            vulnerability,
            likelihood,
            impact,
            riskLevel,
            cvssScore
        };
        this.risks.push(risk);
        return risk;
    }

    generateTemplate() {
        let template = `# Risk Assessment

## Client Information

**Client**: ${this.clientName}
**Assessment Date**: [Date]

## Risk Matrix

| Vulnerability | Likelihood | Impact | Risk Level | CVSS Score |
|--------------|------------|--------|------------|------------|
`;
        
        if (this.risks.length > 0) {
            this.risks.forEach(risk => {
                template += `| ${risk.vulnerability} | ${risk.likelihood} | ${risk.impact} | ${risk.riskLevel} | ${risk.cvssScore || 'N/A'} |\n`;
            });
        } else {
            template += `| [Vulnerability Name] | [High/Medium/Low] | [High/Medium/Low] | [Critical/High/Medium/Low] | [CVSS Score] |\n`;
        }
        
        template += `
## Risk Levels

### Critical Risk
- **Likelihood**: High
- **Impact**: High
- **Description**: Immediate action required

### High Risk
- **Likelihood**: High/Medium
- **Impact**: High/Medium
- **Description**: Address within 30 days

### Medium Risk
- **Likelihood**: Medium
- **Impact**: Medium
- **Description**: Address within 90 days

### Low Risk
- **Likelihood**: Low
- **Impact**: Low
- **Description**: Address as part of regular maintenance

## Risk Summary

### Critical Risks
[Number] critical risks identified requiring immediate attention.

### High Risks
[Number] high risks identified requiring prompt remediation.

### Medium Risks
[Number] medium risks identified for planned remediation.

### Low Risks
[Number] low risks identified for future consideration.

## Recommendations

1. **Prioritize Critical and High Risks**: Address immediately
2. **Implement Security Controls**: Prevent future vulnerabilities
3. **Regular Assessments**: Conduct periodic security assessments
4. **Security Training**: Educate staff on security best practices

---
*This is a template. Replace placeholders with actual risk assessment data.*
`;
        
        return template;
    }

    saveTemplate(filename = null) {
        if (!filename) {
            filename = `risk_assessment_${this.clientName.replace(/ /g, '_')}.md`;
        }
        
        const template = this.generateTemplate();
        
        fs.writeFileSync(filename, template, 'utf8');
        
        console.log(`[+] Risk assessment template saved to ${filename}`);
        return filename;
    }
}

function main() {
    const clientName = process.argv[2] || 'Client Name';
    
    const generator = new RiskAssessmentTemplate(clientName);
    generator.saveTemplate();
    
    console.log('[+] Risk assessment template generated');
}

if (require.main === module) {
    main();
}

module.exports = RiskAssessmentTemplate;

