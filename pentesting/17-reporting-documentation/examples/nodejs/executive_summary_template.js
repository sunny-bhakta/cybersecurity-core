#!/usr/bin/env node
/**
 * Executive Summary Template Generator
 * Generates executive summary templates for penetration testing reports.
 */

const fs = require('fs');

class ExecutiveSummaryTemplate {
    constructor(clientName, projectName) {
        this.clientName = clientName;
        this.projectName = projectName;
        this.date = new Date().toISOString().split('T')[0];
    }

    generateTemplate(stats = null) {
        if (!stats) {
            stats = {
                totalVulnerabilities: 0,
                critical: 0,
                high: 0,
                medium: 0,
                low: 0
            };
        }
        
        return `# Executive Summary

## Project Information

**Client**: ${this.clientName}
**Project**: ${this.projectName}
**Date**: ${this.date}
**Assessment Type**: Penetration Test

## Overview

This executive summary provides a high-level overview of the security assessment conducted for ${this.clientName}. The assessment identified security vulnerabilities and provides recommendations for remediation.

## Key Findings

### Vulnerability Summary

- **Total Vulnerabilities**: ${stats.totalVulnerabilities}
- **Critical**: ${stats.critical}
- **High**: ${stats.high}
- **Medium**: ${stats.medium}
- **Low**: ${stats.low}

### Risk Assessment

The overall risk level is determined based on the severity and number of vulnerabilities identified during the assessment.

## Business Impact

[Describe the business impact of identified vulnerabilities]

## Recommendations

1. **Immediate Actions**: Address critical and high severity vulnerabilities
2. **Short-term**: Implement security controls and monitoring
3. **Long-term**: Establish security program and regular assessments

## Conclusion

[Provide conclusion and next steps]

---
*This is a template. Replace placeholders with actual assessment data.*
`;
    }

    saveTemplate(filename = null) {
        if (!filename) {
            filename = `executive_summary_${this.clientName.replace(/ /g, '_')}.md`;
        }
        
        const template = this.generateTemplate();
        
        fs.writeFileSync(filename, template, 'utf8');
        
        console.log(`[+] Executive summary template saved to ${filename}`);
        return filename;
    }
}

function main() {
    if (process.argv.length < 4) {
        console.log('Usage: node executive_summary_template.js <client_name> <project_name>');
        console.log('Example: node executive_summary_template.js "Acme Corp" "Web Application Assessment"');
        process.exit(1);
    }
    
    const clientName = process.argv[2];
    const projectName = process.argv[3];
    
    const generator = new ExecutiveSummaryTemplate(clientName, projectName);
    generator.saveTemplate();
    
    console.log('[+] Executive summary template generated');
}

if (require.main === module) {
    main();
}

module.exports = ExecutiveSummaryTemplate;

