#!/usr/bin/env python3
"""
Google Dorking Tool
Performs advanced Google searches to find sensitive information.
"""

import sys
import urllib.parse
from typing import List, Dict

class GoogleDorking:
    def __init__(self):
        self.dorks = []
        self.results = []
    
    def build_dork(self, site: str = None, filetype: str = None, 
                   inurl: str = None, intitle: str = None,
                   intext: str = None, cache: bool = False) -> str:
        """Build a Google dork query"""
        query_parts = []
        
        if site:
            query_parts.append(f"site:{site}")
        if filetype:
            query_parts.append(f"filetype:{filetype}")
        if inurl:
            query_parts.append(f"inurl:{inurl}")
        if intitle:
            query_parts.append(f"intitle:{intitle}")
        if intext:
            query_parts.append(f"intext:{intext}")
        
        query = " ".join(query_parts)
        
        if cache:
            query += " cache:"
        
        return query
    
    def generate_common_dorks(self, domain: str) -> List[Dict]:
        """Generate common Google dorks for a domain"""
        dorks = [
            {
                'name': 'PDF Files',
                'query': self.build_dork(site=domain, filetype='pdf'),
                'description': 'Find PDF files on the domain'
            },
            {
                'name': 'Configuration Files',
                'query': self.build_dork(site=domain, filetype='conf'),
                'description': 'Find configuration files'
            },
            {
                'name': 'Backup Files',
                'query': self.build_dork(site=domain, filetype='bak'),
                'description': 'Find backup files'
            },
            {
                'name': 'Admin Panels',
                'query': self.build_dork(site=domain, inurl='admin'),
                'description': 'Find admin panels'
            },
            {
                'name': 'Login Pages',
                'query': self.build_dork(site=domain, inurl='login'),
                'description': 'Find login pages'
            },
            {
                'name': 'Index of Directories',
                'query': self.build_dork(site=domain, intitle='index of'),
                'description': 'Find directory listings'
            },
            {
                'name': 'SQL Files',
                'query': self.build_dork(site=domain, filetype='sql'),
                'description': 'Find SQL files'
            },
            {
                'name': 'API Keys',
                'query': self.build_dork(site=domain, intext='api_key'),
                'description': 'Find potential API keys'
            },
            {
                'name': 'Passwords',
                'query': self.build_dork(site=domain, intext='password'),
                'description': 'Find password references'
            },
            {
                'name': 'Private Keys',
                'query': self.build_dork(site=domain, filetype='pem'),
                'description': 'Find private key files'
            }
        ]
        
        return dorks
    
    def format_google_url(self, query: str) -> str:
        """Format query as Google search URL"""
        encoded_query = urllib.parse.quote_plus(query)
        return f"https://www.google.com/search?q={encoded_query}"
    
    def generate_report(self, domain: str) -> str:
        """Generate Google dorking report"""
        dorks = self.generate_common_dorks(domain)
        
        report = f"# Google Dorking Report for {domain}\n\n"
        report += "## Generated Dorks\n\n"
        report += "**Note**: These are search queries. Copy and paste them into Google Search.\n\n"
        
        for i, dork in enumerate(dorks, 1):
            report += f"### {i}. {dork['name']}\n\n"
            report += f"**Description**: {dork['description']}\n\n"
            report += f"**Query**: `{dork['query']}`\n\n"
            report += f"**Google URL**: {self.format_google_url(dork['query'])}\n\n"
            report += "---\n\n"
        
        report += "## Usage Instructions\n\n"
        report += "1. Copy each query and paste into Google Search\n"
        report += "2. Review results for sensitive information\n"
        report += "3. Document findings\n"
        report += "4. Report any sensitive data discovered\n\n"
        report += "## Legal Warning\n\n"
        report += "⚠️ **WARNING**: Only use these queries on domains you own or have permission to test!\n"
        report += "Unauthorized access to sensitive information is illegal.\n"
        
        return report

def main():
    if len(sys.argv) < 2:
        print("Usage: python google_dorking.py <domain>")
        print("Example: python google_dorking.py example.com")
        sys.exit(1)
    
    domain = sys.argv[1]
    dorking = GoogleDorking()
    
    report = dorking.generate_report(domain)
    
    filename = f"google_dorks_{domain.replace('.', '_')}.md"
    with open(filename, 'w') as f:
        f.write(report)
    
    print(f"[+] Generated {len(dorking.generate_common_dorks(domain))} Google dorks for {domain}")
    print(f"[+] Report saved to {filename}")
    print(f"[!] WARNING: Only use on domains you own or have permission to test!")

if __name__ == '__main__':
    main()

