#!/usr/bin/env python3
"""
Social Media Intelligence Tool
Gathers intelligence from social media platforms.
"""

import sys
import requests
from typing import Dict, List

class SocialMediaIntelligence:
    def __init__(self, target: str):
        self.target = target
        self.findings = []
    
    def search_twitter(self) -> List[Dict]:
        """Search Twitter for target mentions"""
        print(f"[*] Searching Twitter for mentions of: {self.target}...")
        
        results = []
        # In real implementation, would use Twitter API
        # This is a simplified example
        print("[!] Note: Real implementation requires Twitter API credentials")
        
        return results
    
    def search_linkedin(self) -> List[Dict]:
        """Search LinkedIn for target information"""
        print(f"[*] Searching LinkedIn for: {self.target}...")
        
        results = []
        # In real implementation, would use LinkedIn API or scraping
        # This is a simplified example
        print("[!] Note: LinkedIn requires authentication and has rate limits")
        
        return results
    
    def search_github(self) -> List[Dict]:
        """Search GitHub for target-related repositories"""
        print(f"[*] Searching GitHub for: {self.target}...")
        
        results = []
        try:
            url = f"https://api.github.com/search/repositories?q={self.target}"
            response = requests.get(url, timeout=10)
            
            if response.status_code == 200:
                data = response.json()
                for item in data.get('items', [])[:10]:
                    results.append({
                        'name': item.get('name', ''),
                        'url': item.get('html_url', ''),
                        'description': item.get('description', '')
                    })
        except Exception as e:
            print(f"[-] Error: {e}")
        
        return results
    
    def search_reddit(self) -> List[Dict]:
        """Search Reddit for target mentions"""
        print(f"[*] Searching Reddit for: {self.target}...")
        
        results = []
        try:
            url = f"https://www.reddit.com/search.json?q={self.target}"
            response = requests.get(
                url,
                headers={'User-Agent': 'OSINT-Tool/1.0'},
                timeout=10
            )
            
            if response.status_code == 200:
                data = response.json()
                for item in data.get('data', {}).get('children', [])[:10]:
                    post = item.get('data', {})
                    results.append({
                        'title': post.get('title', ''),
                        'url': post.get('url', ''),
                        'subreddit': post.get('subreddit', '')
                    })
        except Exception as e:
            print(f"[-] Error: {e}")
        
        return results
    
    def search_all(self) -> Dict:
        """Search all social media platforms"""
        print(f"[*] Starting social media intelligence gathering for: {self.target}\n")
        
        results = {
            'twitter': self.search_twitter(),
            'linkedin': self.search_linkedin(),
            'github': self.search_github(),
            'reddit': self.search_reddit()
        }
        
        return results
    
    def generate_report(self) -> str:
        """Generate social media intelligence report"""
        results = self.search_all()
        
        report = f"# Social Media Intelligence Report for {self.target}\n\n"
        
        # GitHub results
        if results.get('github'):
            report += "## GitHub Repositories\n\n"
            for repo in results['github']:
                report += f"- **{repo['name']}**: {repo.get('description', 'No description')}\n"
                report += f"  - URL: {repo['url']}\n"
            report += "\n"
        
        # Reddit results
        if results.get('reddit'):
            report += "## Reddit Mentions\n\n"
            for post in results['reddit']:
                report += f"- **{post['title']}**\n"
                report += f"  - Subreddit: r/{post['subreddit']}\n"
                report += f"  - URL: {post['url']}\n"
            report += "\n"
        
        # Twitter results
        if results.get('twitter'):
            report += "## Twitter Mentions\n\n"
            for tweet in results['twitter']:
                report += f"- {tweet}\n"
            report += "\n"
        
        # LinkedIn results
        if results.get('linkedin'):
            report += "## LinkedIn Information\n\n"
            for item in results['linkedin']:
                report += f"- {item}\n"
            report += "\n"
        
        report += "## Legal and Ethical Considerations\n\n"
        report += "⚠️ **WARNING**: Social media intelligence gathering must comply with:\n"
        report += "1. **Terms of Service**: Respect each platform's ToS\n"
        report += "2. **Privacy Laws**: GDPR, CCPA, and other privacy regulations\n"
        report += "3. **Rate Limits**: Respect API rate limits\n"
        report += "4. **Ethical Use**: Only gather publicly available information\n"
        report += "5. **Authorization**: Only use for authorized investigations\n\n"
        
        return report

def main():
    if len(sys.argv) < 2:
        print("Usage: python social_media_intelligence.py <target>")
        print("Example: python social_media_intelligence.py example.com")
        sys.exit(1)
    
    target = sys.argv[1]
    
    tool = SocialMediaIntelligence(target)
    
    report = tool.generate_report()
    
    filename = f"social_media_intel_{target.replace('.', '_')}.md"
    with open(filename, 'w') as f:
        f.write(report)
    
    print(f"[+] Social media intelligence gathering complete")
    print(f"[+] Report saved to {filename}")
    print(f"[!] WARNING: Only use for authorized investigations!")

if __name__ == '__main__':
    main()

