#!/usr/bin/env python3
"""
Phishing Template Generator
Generates phishing email templates for security awareness training.
WARNING: Only use for authorized security awareness training!
"""

import sys
from typing import Dict, List
from datetime import datetime

class PhishingTemplateGenerator:
    def __init__(self):
        self.templates = {}
    
    def generate_credential_harvesting_template(self, target_url: str, 
                                                company_name: str = "Your Company") -> str:
        """Generate credential harvesting phishing template"""
        template = f"""Subject: Urgent: Verify Your Account

Dear {company_name} User,

We have detected unusual activity on your account. For your security, please verify your credentials immediately.

Click here to verify: {target_url}

If you do not verify within 24 hours, your account will be suspended.

Thank you,
{company_name} Security Team

---
This is a security awareness training email. Only click links from trusted sources.
"""
        return template
    
    def generate_attachment_template(self, attachment_name: str = "invoice.pdf",
                                    company_name: str = "Your Company") -> str:
        """Generate attachment-based phishing template"""
        template = f"""Subject: Invoice #{datetime.now().strftime('%Y%m%d')}

Dear Customer,

Please find attached your invoice for this month.

Attachment: {attachment_name}

If you have any questions, please contact our billing department.

Best regards,
{company_name} Billing Team

---
This is a security awareness training email. Be cautious of unexpected attachments.
"""
        return template
    
    def generate_urgent_action_template(self, action: str = "update payment information",
                                       company_name: str = "Your Company") -> str:
        """Generate urgent action phishing template"""
        template = f"""Subject: Action Required: {action.title()}

Dear Valued Customer,

We need you to {action} immediately to avoid service interruption.

Click here to update: [LINK]

This is urgent - please complete this within the next 2 hours.

Thank you for your immediate attention.

{company_name} Support Team

---
This is a security awareness training email. Verify urgent requests through official channels.
"""
        return template
    
    def generate_social_media_template(self, platform: str = "LinkedIn",
                                      company_name: str = "Your Company") -> str:
        """Generate social media phishing template"""
        template = f"""Subject: New Message on {platform}

Hi there,

You have a new message on {platform} from {company_name}.

Click here to view: [LINK]

Best regards,
{platform} Team

---
This is a security awareness training email. Always access social media through official apps/websites.
"""
        return template
    
    def generate_all_templates(self, target_url: str = "http://example.com/login",
                              company_name: str = "Your Company") -> Dict[str, str]:
        """Generate all phishing templates"""
        return {
            'credential_harvesting': self.generate_credential_harvesting_template(target_url, company_name),
            'attachment': self.generate_attachment_template(company_name=company_name),
            'urgent_action': self.generate_urgent_action_template(company_name=company_name),
            'social_media': self.generate_social_media_template(company_name=company_name)
        }
    
    def save_templates(self, filename: str = 'phishing_templates.txt',
                      target_url: str = "http://example.com/login",
                      company_name: str = "Your Company"):
        """Save all templates to file"""
        templates = self.generate_all_templates(target_url, company_name)
        
        with open(filename, 'w') as f:
            f.write("# Phishing Email Templates\n")
            f.write("# WARNING: Only use for authorized security awareness training!\n")
            f.write(f"# Generated: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n\n")
            
            for name, template in templates.items():
                f.write(f"## {name.replace('_', ' ').title()}\n\n")
                f.write(template)
                f.write("\n\n---\n\n")
        
        print(f"[+] Templates saved to {filename}")
        print(f"[!] WARNING: Only use for authorized security awareness training!")

def main():
    generator = PhishingTemplateGenerator()
    
    if len(sys.argv) > 1:
        template_type = sys.argv[1]
        target_url = sys.argv[2] if len(sys.argv) > 2 else "http://example.com/login"
        company = sys.argv[3] if len(sys.argv) > 3 else "Your Company"
        
        if template_type == 'credential':
            print(generator.generate_credential_harvesting_template(target_url, company))
        elif template_type == 'attachment':
            print(generator.generate_attachment_template(company_name=company))
        elif template_type == 'urgent':
            print(generator.generate_urgent_action_template(company_name=company))
        elif template_type == 'social':
            print(generator.generate_social_media_template(company_name=company))
        else:
            generator.save_templates(target_url=target_url, company_name=company)
    else:
        generator.save_templates()
        print("\n[+] Usage examples:")
        print("  python phishing_template_generator.py credential http://example.com/login 'Company Name'")
        print("  python phishing_template_generator.py attachment")
        print("  python phishing_template_generator.py urgent")
        print("  python phishing_template_generator.py social")

if __name__ == '__main__':
    main()

