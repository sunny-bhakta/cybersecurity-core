/**
 * Phishing Template Generator
 * Generates phishing email templates for security awareness training.
 * WARNING: Only use for authorized security awareness training!
 */

const fs = require('fs');

class PhishingTemplateGenerator {
    constructor() {
        this.templates = {};
    }

    generateCredentialHarvestingTemplate(targetUrl, companyName = 'Your Company') {
        return `Subject: Urgent: Verify Your Account

Dear ${companyName} User,

We have detected unusual activity on your account. For your security, please verify your credentials immediately.

Click here to verify: ${targetUrl}

If you do not verify within 24 hours, your account will be suspended.

Thank you,
${companyName} Security Team

---
This is a security awareness training email. Only click links from trusted sources.
`;
    }

    generateAttachmentTemplate(attachmentName = 'invoice.pdf', companyName = 'Your Company') {
        const date = new Date().toISOString().split('T')[0].replace(/-/g, '');
        return `Subject: Invoice #${date}

Dear Customer,

Please find attached your invoice for this month.

Attachment: ${attachmentName}

If you have any questions, please contact our billing department.

Best regards,
${companyName} Billing Team

---
This is a security awareness training email. Be cautious of unexpected attachments.
`;
    }

    generateUrgentActionTemplate(action = 'update payment information', companyName = 'Your Company') {
        return `Subject: Action Required: ${action.charAt(0).toUpperCase() + action.slice(1)}

Dear Valued Customer,

We need you to ${action} immediately to avoid service interruption.

Click here to update: [LINK]

This is urgent - please complete this within the next 2 hours.

Thank you for your immediate attention.

${companyName} Support Team

---
This is a security awareness training email. Verify urgent requests through official channels.
`;
    }

    generateSocialMediaTemplate(platform = 'LinkedIn', companyName = 'Your Company') {
        return `Subject: New Message on ${platform}

Hi there,

You have a new message on ${platform} from ${companyName}.

Click here to view: [LINK]

Best regards,
${platform} Team

---
This is a security awareness training email. Always access social media through official apps/websites.
`;
    }

    generateAllTemplates(targetUrl = 'http://example.com/login', companyName = 'Your Company') {
        return {
            credential_harvesting: this.generateCredentialHarvestingTemplate(targetUrl, companyName),
            attachment: this.generateAttachmentTemplate(undefined, companyName),
            urgent_action: this.generateUrgentActionTemplate(undefined, companyName),
            social_media: this.generateSocialMediaTemplate(undefined, companyName)
        };
    }

    saveTemplates(filename = 'phishing_templates.txt', targetUrl = 'http://example.com/login', companyName = 'Your Company') {
        const templates = this.generateAllTemplates(targetUrl, companyName);
        const date = new Date().toISOString();
        
        let content = '# Phishing Email Templates\n';
        content += '# WARNING: Only use for authorized security awareness training!\n';
        content += `# Generated: ${date}\n\n`;
        
        for (const [name, template] of Object.entries(templates)) {
            const title = name.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
            content += `## ${title}\n\n`;
            content += template;
            content += '\n\n---\n\n';
        }
        
        fs.writeFileSync(filename, content, 'utf8');
        console.log(`[+] Templates saved to ${filename}`);
        console.log(`[!] WARNING: Only use for authorized security awareness training!`);
    }
}

function main() {
    const args = process.argv.slice(2);
    const generator = new PhishingTemplateGenerator();

    if (args.length > 0) {
        const templateType = args[0];
        const targetUrl = args[1] || 'http://example.com/login';
        const company = args[2] || 'Your Company';

        if (templateType === 'credential') {
            console.log(generator.generateCredentialHarvestingTemplate(targetUrl, company));
        } else if (templateType === 'attachment') {
            console.log(generator.generateAttachmentTemplate(undefined, company));
        } else if (templateType === 'urgent') {
            console.log(generator.generateUrgentActionTemplate(undefined, company));
        } else if (templateType === 'social') {
            console.log(generator.generateSocialMediaTemplate(undefined, company));
        } else {
            generator.saveTemplates(undefined, targetUrl, company);
        }
    } else {
        generator.saveTemplates();
        console.log('\n[+] Usage examples:');
        console.log('  node phishing_template_generator.js credential http://example.com/login "Company Name"');
        console.log('  node phishing_template_generator.js attachment');
        console.log('  node phishing_template_generator.js urgent');
        console.log('  node phishing_template_generator.js social');
    }
}

if (require.main === module) {
    main();
}

module.exports = PhishingTemplateGenerator;

