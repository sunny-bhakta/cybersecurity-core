#!/usr/bin/env node
/**
 * Pretexting Tool
 * Demonstrates pretexting techniques (for authorized testing only).
 */

const fs = require('fs');

class Pretexting {
    constructor() {
        this.scenarios = [];
    }

    createPretext(scenario, role, target) {
        console.log(`[*] Creating pretext: ${scenario}...`);
        console.log(`[*] Role: ${role}, Target: ${target}`);
        
        const scripts = {
            'IT Support': 'Hello, this is IT support. We need to verify your account...',
            'Bank Official': 'Hello, this is your bank. We detected suspicious activity...',
            'Government': 'Hello, this is [Agency]. We need to verify your information...',
            'Vendor': 'Hello, this is [Company]. We need to update your account...'
        };
        
        return {
            scenario,
            role,
            target,
            script: scripts[role] || 'Generic pretext script'
        };
    }

    gatherInformation(pretext) {
        console.log(`[*] Gathering information using pretext: ${pretext.scenario}...`);
        
        const targets = [
            'Username',
            'Password',
            'SSN',
            'Credit Card',
            'Date of Birth',
            'Security Questions'
        ];
        
        return targets;
    }

    generateReport() {
        let report = `# Pretexting Report\n\n`;
        
        report += `⚠️ **WARNING**: This tool is for authorized security testing only!\n\n`;
        
        report += `## Pretexting Overview\n\n`;
        report += `Pretexting is a social engineering technique where an attacker creates\n`;
        report += `a false scenario (pretext) to obtain information or access.\n\n`;
        
        report += `## Attack Process\n\n`;
        report += `1. Attacker creates false identity/scenario\n`;
        report += `2. Attacker contacts target using pretext\n`;
        report += `3. Target provides information believing pretext\n`;
        report += `4. Attacker uses information for malicious purposes\n\n`;
        
        report += `## Common Pretexting Scenarios\n\n`;
        report += `1. **IT Support**: Impersonating IT staff\n`;
        report += `2. **Bank Official**: Impersonating bank employees\n`;
        report += `3. **Government**: Impersonating government agencies\n`;
        report += `4. **Vendor**: Impersonating trusted vendors\n`;
        report += `5. **Colleague**: Impersonating coworkers\n\n`;
        
        report += `## Information Gathering Techniques\n\n`;
        report += `1. **Authority**: Use authority to gain trust\n`;
        report += `2. **Urgency**: Create sense of urgency\n`;
        report += `3. **Familiarity**: Use familiar information\n`;
        report += `4. **Verification**: Request verification of information\n`;
        report += `5. **Social Proof**: Reference known information\n\n`;
        
        report += `## Detection Methods\n\n`;
        report += `1. **Identity Verification**: Verify caller identity\n`;
        report += `2. **Request Verification**: Verify requests through other channels\n`;
        report += `3. **Training**: Security awareness training\n`;
        report += `4. **Policies**: Clear information sharing policies\n\n`;
        
        report += `## Prevention\n\n`;
        report += `1. Verify identity independently\n`;
        report += `2. Never share sensitive info without verification\n`;
        report += `3. Use security awareness training\n`;
        report += `4. Implement information sharing policies\n`;
        report += `5. Report suspicious requests\n\n`;
        
        report += `## Legal and Ethical Considerations\n\n`;
        report += `⚠️ **WARNING**: Pretexting should only be performed:\n`;
        report += `- With explicit written authorization\n`;
        report += `- In controlled testing environments\n`;
        report += `- Following responsible disclosure practices\n`;
        report += `- **Pretexting may be illegal in many jurisdictions!**\n\n`;
        
        return report;
    }
}

function main() {
    console.log('Pretexting Tool');
    console.log('='.repeat(50));
    console.log('⚠️ WARNING: This tool is for authorized security testing only!');
    console.log('⚠️ Only use with explicit written authorization!\n');
    
    const pretexting = new Pretexting();
    const report = pretexting.generateReport();
    
    const filename = 'pretexting_report.md';
    fs.writeFileSync(filename, report, 'utf8');
    
    console.log(`[+] Pretexting tool structure created`);
    console.log(`[+] Report saved to ${filename}`);
}

if (require.main === module) {
    main();
}

module.exports = Pretexting;

