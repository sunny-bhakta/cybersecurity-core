#!/usr/bin/env python3
"""
Scope Definition Template Generator
Generates penetration testing scope definition documents.
"""

import sys
from datetime import datetime
from typing import Dict, List

class ScopeDefinitionTemplate:
    def __init__(self):
        self.template = {
            'project_name': '',
            'client_name': '',
            'test_dates': {'start': '', 'end': ''},
            'in_scope': [],
            'out_of_scope': [],
            'objectives': [],
            'constraints': [],
            'rules_of_engagement': []
        }
    
    def add_in_scope(self, items: List[str]):
        """Add in-scope items"""
        self.template['in_scope'].extend(items)
    
    def add_out_of_scope(self, items: List[str]):
        """Add out-of-scope items"""
        self.template['out_of_scope'].extend(items)
    
    def add_objectives(self, objectives: List[str]):
        """Add test objectives"""
        self.template['objectives'].extend(objectives)
    
    def add_constraints(self, constraints: List[str]):
        """Add test constraints"""
        self.template['constraints'].extend(constraints)
    
    def add_rules_of_engagement(self, rules: List[str]):
        """Add rules of engagement"""
        self.template['rules_of_engagement'].extend(rules)
    
    def generate_scope_document(self) -> str:
        """Generate scope definition document"""
        doc = f"""# Penetration Testing Scope Definition

## Project Information

**Project Name**: {self.template['project_name']}
**Client Name**: {self.template['client_name']}
**Test Period**: {self.template['test_dates']['start']} to {self.template['test_dates']['end']}
**Document Date**: {datetime.now().strftime('%Y-%m-%d')}

---

## Executive Summary

This document defines the scope, objectives, and constraints for the penetration testing engagement.

---

## Test Objectives

The primary objectives of this penetration test are:

"""
        for i, obj in enumerate(self.template['objectives'], 1):
            doc += f"{i}. {obj}\n"
        
        doc += "\n---\n\n## In-Scope Assets\n\n"
        doc += "The following assets, systems, and networks are **IN SCOPE** for this engagement:\n\n"
        
        for i, item in enumerate(self.template['in_scope'], 1):
            doc += f"{i}. {item}\n"
        
        doc += "\n---\n\n## Out-of-Scope Assets\n\n"
        doc += "The following assets, systems, and networks are **OUT OF SCOPE** for this engagement:\n\n"
        
        for i, item in enumerate(self.template['out_of_scope'], 1):
            doc += f"{i}. {item}\n"
        
        doc += "\n---\n\n## Test Constraints\n\n"
        doc += "The following constraints apply to this engagement:\n\n"
        
        for i, constraint in enumerate(self.template['constraints'], 1):
            doc += f"{i}. {constraint}\n"
        
        doc += "\n---\n\n## Rules of Engagement\n\n"
        doc += "The following rules of engagement must be followed:\n\n"
        
        for i, rule in enumerate(self.template['rules_of_engagement'], 1):
            doc += f"{i}. {rule}\n"
        
        doc += "\n---\n\n## Signatures\n\n"
        doc += "**Client Representative**: _________________ Date: _________\n\n"
        doc += "**Testing Team Lead**: _________________ Date: _________\n\n"
        
        return doc
    
    def set_project_info(self, project_name: str, client_name: str, start_date: str, end_date: str):
        """Set project information"""
        self.template['project_name'] = project_name
        self.template['client_name'] = client_name
        self.template['test_dates']['start'] = start_date
        self.template['test_dates']['end'] = end_date

def main():
    print("Scope Definition Template Generator")
    print("=" * 50)
    
    scope = ScopeDefinitionTemplate()
    
    # Set project information
    scope.set_project_info(
        project_name="Example Corp Security Assessment",
        client_name="Example Corporation",
        start_date="2024-01-15",
        end_date="2024-01-20"
    )
    
    # Add objectives
    scope.add_objectives([
        "Identify security vulnerabilities in web applications",
        "Test network security controls",
        "Assess authentication and authorization mechanisms",
        "Evaluate data protection measures"
    ])
    
    # Add in-scope items
    scope.add_in_scope([
        "Web application: https://app.example.com",
        "API endpoints: https://api.example.com",
        "Network range: 192.168.1.0/24",
        "Mobile application: ExampleApp v2.0"
    ])
    
    # Add out-of-scope items
    scope.add_out_of_scope([
        "Production database (read-only access only)",
        "Third-party services",
        "Social engineering attacks",
        "Physical security testing",
        "Denial of Service (DoS) attacks"
    ])
    
    # Add constraints
    scope.add_constraints([
        "Testing hours: 09:00 - 17:00 EST only",
        "No testing during maintenance windows",
        "No data modification or deletion",
        "Immediate notification required for critical findings"
    ])
    
    # Add rules of engagement
    scope.add_rules_of_engagement([
        "Obtain explicit permission before testing",
        "Document all testing activities",
        "Maintain confidentiality of findings",
        "Follow responsible disclosure practices",
        "Comply with applicable laws and regulations"
    ])
    
    # Generate document
    document = scope.generate_scope_document()
    
    # Save to file
    filename = "scope_definition.md"
    with open(filename, 'w') as f:
        f.write(document)
    
    print(f"[+] Scope definition document generated")
    print(f"[+] Saved to: {filename}")
    print("\n[!] Review and customize the document before use")

if __name__ == '__main__':
    main()

