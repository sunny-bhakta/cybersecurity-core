#!/usr/bin/env python3
"""
Log Manipulation Tool
Demonstrates log manipulation techniques (for educational purposes).
"""

import sys
import os
from typing import List

class LogManipulation:
    def __init__(self):
        self.manipulated_logs = []
    
    def clear_logs(self, log_file: str) -> bool:
        """Clear log file contents"""
        print(f"[*] Clearing logs: {log_file}...")
        
        try:
            if os.path.exists(log_file):
                with open(log_file, 'w') as f:
                    f.write('')
                print(f"[+] Logs cleared: {log_file}")
                return True
        except Exception as e:
            print(f"[-] Error: {e}")
        
        return False
    
    def remove_entries(self, log_file: str, pattern: str) -> bool:
        """Remove specific entries from log file"""
        print(f"[*] Removing entries matching pattern: {pattern}...")
        
        try:
            if os.path.exists(log_file):
                with open(log_file, 'r') as f:
                    lines = f.readlines()
                
                filtered_lines = [line for line in lines if pattern not in line]
                
                with open(log_file, 'w') as f:
                    f.writelines(filtered_lines)
                
                print(f"[+] Entries removed from: {log_file}")
                return True
        except Exception as e:
            print(f"[-] Error: {e}")
        
        return False
    
    def modify_timestamps(self, log_file: str) -> bool:
        """Modify log file timestamps"""
        print(f"[*] Modifying timestamps: {log_file}...")
        
        try:
            # Modify file access/modification time
            import time
            current_time = time.time()
            os.utime(log_file, (current_time, current_time))
            print(f"[+] Timestamps modified: {log_file}")
            return True
        except Exception as e:
            print(f"[-] Error: {e}")
        
        return False
    
    def generate_report(self) -> str:
        """Generate log manipulation report"""
        report = "# Log Manipulation Report\n\n"
        
        report += "⚠️ **WARNING**: This tool is for educational purposes only!\n\n"
        
        report += "## Log Manipulation Techniques\n\n"
        
        techniques = [
            "1. **Log Clearing**: Delete log file contents",
            "2. **Entry Removal**: Remove specific log entries",
            "3. **Timestamp Modification**: Alter file timestamps",
            "4. **Log Injection**: Inject false entries",
            "5. **Log Rotation**: Exploit log rotation mechanisms"
        ]
        
        for technique in techniques:
            report += f"{technique}\n"
        report += "\n"
        
        report += "## Detection Methods\n\n"
        report += "1. **Log Integrity Monitoring**: Monitor for log modifications\n"
        report += "2. **Centralized Logging**: Send logs to remote server\n"
        report += "3. **Write-Once Storage**: Use append-only logs\n"
        report += "4. **File Integrity Monitoring**: Monitor file changes\n"
        report += "5. **Audit Logging**: Log access to log files\n\n"
        
        report += "## Prevention\n\n"
        report += "1. Use centralized logging\n"
        report += "2. Implement log integrity checks\n"
        report += "3. Restrict log file access\n"
        report += "4. Use append-only log storage\n"
        report += "5. Monitor for log anomalies\n\n"
        
        report += "## Legal and Ethical Considerations\n\n"
        report += "⚠️ **WARNING**: Log manipulation should only be performed:\n"
        report += "- On systems you own\n"
        report += "- With explicit written authorization\n"
        report += "- In controlled testing environments\n"
        report += "- Following responsible disclosure practices\n\n"
        
        return report

def main():
    print("Log Manipulation Tool")
    print("=" * 50)
    print("⚠️ WARNING: This tool is for authorized security testing only!")
    print("⚠️ Only use on systems you own or have permission to test!\n")
    
    tool = LogManipulation()
    report = tool.generate_report()
    
    filename = "log_manipulation_report.md"
    with open(filename, 'w') as f:
        f.write(report)
    
    print(f"[+] Log manipulation tool structure created")
    print(f"[+] Report saved to {filename}")

if __name__ == "__main__":
    main()

