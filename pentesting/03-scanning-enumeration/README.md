# 03. Scanning & Enumeration

## Overview

Scanning and enumeration involve actively probing target systems to discover open ports, services, and gather detailed information about the target infrastructure.

## Network Scanning

### Port Scanning Techniques

#### TCP Connect Scan
- Full TCP handshake
- Most reliable but easily detected
- Requires root privileges on some systems

#### TCP SYN Scan (Stealth Scan)
- Half-open connection
- Faster and less detectable
- Requires root privileges

#### TCP FIN Scan
- Sends FIN packet
- Bypasses some firewalls
- No response = port open

#### TCP Xmas Scan
- Sets FIN, PSH, URG flags
- Similar to FIN scan
- Stealth technique

#### TCP NULL Scan
- No flags set
- Stealth scanning
- Bypasses some IDS

#### UDP Scan
- Scans UDP ports
- Slower than TCP
- Often unreliable

#### ACK Scan
- Tests firewall rules
- Determines if port is filtered
- Not for port discovery

#### Window Scan
- Uses TCP window size
- Can detect open ports
- Less common

#### Idle Scan (Zombie Scan)
- Uses third-party host
- Very stealthy
- Complex to execute

### Network Discovery

- **Network Topology Discovery**
  - Identifying network structure
  - Router and switch locations
  - Network segmentation

- **OS Detection (OS Fingerprinting)**
  - Identifying operating systems
  - TCP/IP stack fingerprinting
  - Banner grabbing

- **Service Version Detection**
  - Identifying service versions
  - Vulnerability correlation
  - Exploit selection

- **Firewall Detection**
  - Identifying firewall presence
  - Rule enumeration
  - Bypass techniques

- **IDS/IPS Evasion Techniques**
  - Fragmentation
  - Timing manipulation
  - Decoy scanning

## Enumeration

### Service Enumeration

#### SMB Enumeration
- Windows file sharing
- User enumeration
- Share enumeration
- Null session attacks

#### SNMP Enumeration
- Network device information
- Community string brute forcing
- MIB walking

#### LDAP Enumeration
- Directory service enumeration
- User and group enumeration
- Schema enumeration

#### NFS Enumeration
- Network File System
- Share enumeration
- Permission testing

#### RPC Enumeration
- Remote Procedure Call
- Service enumeration
- Version detection

#### FTP Enumeration
- Anonymous login testing
- Banner grabbing
- Directory enumeration

#### SSH Enumeration
- Version detection
- Key exchange testing
- Username enumeration

#### SMTP Enumeration
- Mail server information
- User enumeration (VRFY, EXPN)
- Relay testing

#### HTTP/HTTPS Enumeration
- Web server enumeration
- Directory brute forcing
- Technology stack identification

### Database Enumeration

#### MySQL
- User enumeration
- Database enumeration
- Version detection

#### MSSQL
- Instance enumeration
- Database enumeration
- Linked server discovery

#### PostgreSQL
- Database enumeration
- User enumeration
- Extension enumeration

#### Oracle
- TNS enumeration
- Database enumeration
- User enumeration

#### MongoDB
- Database enumeration
- Collection enumeration
- Authentication bypass

## Tools

- **nmap**: Network mapper and port scanner
- **Masscan**: Fast port scanner
- **RustScan**: Modern port scanner
- **enum4linux**: SMB enumeration
- **SNMPwalk**: SNMP enumeration
- **ldapsearch**: LDAP enumeration
- **nbtscan**: NetBIOS enumeration

## Code Examples

### Python Examples
See the `examples/` directory for:
- `port_scanner.py` - Port scanning tool with multiple scan types

### Node.js Examples
See the `examples/nodejs/` directory for:
- `port_scanner.js` - Port scanning tool (Node.js)

### Usage
```bash
# Python
python examples/port_scanner.py 192.168.1.1 1 1000
python examples/port_scanner.py 192.168.1.1  # Scans common ports

# Node.js
node examples/nodejs/port_scanner.js 192.168.1.1 1 1000
```

## Best Practices

1. Start with broad scans, then narrow down
2. Use multiple scanning techniques
3. Respect rate limits
4. Document all findings
5. Use stealth techniques when appropriate
6. Verify findings with multiple tools
7. Understand legal implications

---

**Previous**: [02. Reconnaissance & Information Gathering](../02-reconnaissance-information-gathering)  
**Next**: [04. Vulnerability Assessment](../04-vulnerability-assessment)

