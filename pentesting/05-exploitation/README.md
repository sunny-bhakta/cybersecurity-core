# 05. Exploitation

## Overview

Exploitation involves taking advantage of identified vulnerabilities to gain unauthorized access, escalate privileges, or extract sensitive information from target systems.

## Exploitation Frameworks

### Metasploit Framework
- Comprehensive exploitation framework
- Exploit modules for known vulnerabilities
- Payload generation
- Post-exploitation modules
- Meterpreter shell

### Cobalt Strike
- Commercial red team framework
- Advanced post-exploitation
- Team server collaboration
- Beacon payloads

### Empire
- PowerShell and Python post-exploitation
- Modular framework
- Communication profiles

### PowerSploit
- PowerShell exploitation framework
- Post-exploitation modules
- Privilege escalation

## Exploitation Techniques

### Buffer Overflow

#### Stack-based Buffer Overflow
- Overwriting stack memory
- Return address manipulation
- Shellcode injection
- DEP/ASLR bypass

#### Heap-based Buffer Overflow
- Heap memory corruption
- More complex than stack-based
- Heap spraying techniques

#### Format String Vulnerabilities
- Exploiting format specifiers
- Memory read/write
- Code execution

#### Integer Overflow
- Integer manipulation
- Bounds checking bypass
- Memory corruption

### SQL Injection (SQLi)

#### Union-based SQLi
- Data extraction via UNION
- Column count matching
- Direct data retrieval

#### Error-based SQLi
- Information disclosure via errors
- Database structure revelation
- Data extraction

#### Blind SQLi (Boolean-based)
- True/false inference
- Time-consuming
- Bit-by-bit extraction

#### Blind SQLi (Time-based)
- Time delay inference
- Confirms injection
- Very slow

#### Second-order SQLi
- Stored payload execution
- Delayed exploitation
- Harder to detect

### Command Injection
- Operating system command execution
- Shell command injection
- Code execution via input

### Code Injection
- Application code execution
- Script injection
- Remote code execution

### LDAP Injection
- LDAP query manipulation
- Directory service exploitation
- Authentication bypass

### XML Injection
- XML parser exploitation
- XXE (XML External Entity)
- Data extraction

### XPath Injection
- XPath query manipulation
- XML data extraction
- Authentication bypass

### NoSQL Injection
- NoSQL database exploitation
- MongoDB injection
- Authentication bypass

### Server-Side Request Forgery (SSRF)
- Internal service access
- Cloud metadata access
- Port scanning via application

### Server-Side Template Injection (SSTI)
- Template engine exploitation
- Code execution
- Remote command execution

### Remote Code Execution (RCE)
- Arbitrary code execution
- System compromise
- Full system access

### Local File Inclusion (LFI)
- Local file reading
- Source code disclosure
- Configuration file access

### Remote File Inclusion (RFI)
- Remote file execution
- Code execution
- Web shell upload

### Directory Traversal (Path Traversal)
- Accessing files outside web root
- Configuration file reading
- Source code disclosure

### XXE (XML External Entity) Injection
- XML parser exploitation
- File reading
- SSRF via XML

## Privilege Escalation

### Linux Privilege Escalation

#### SUID/SGID Binaries
- Set User ID binaries
- Privilege escalation vectors
- Exploitable binaries

#### Sudo Misconfigurations
- Sudo without password
- Sudo command execution
- Sudo rule abuse

#### Kernel Exploits
- Kernel vulnerability exploitation
- Local privilege escalation
- System compromise

#### Cron Jobs
- Scheduled task exploitation
- Writable cron jobs
- Cron job hijacking

#### PATH Hijacking
- PATH manipulation
- Binary hijacking
- Privilege escalation

#### Capabilities
- Linux capabilities abuse
- Privilege escalation
- Capability exploitation

#### NFS Misconfigurations
- Network File System abuse
- Root squash bypass
- File system access

### Windows Privilege Escalation

#### Unquoted Service Paths
- Service path exploitation
- Binary hijacking
- Privilege escalation

#### DLL Hijacking
- Dynamic Link Library hijacking
- Binary replacement
- Code execution

#### Service Misconfigurations
- Service permission abuse
- Service binary replacement
- Privilege escalation

#### Token Impersonation
- Access token manipulation
- Token theft
- Privilege escalation

#### Registry Misconfigurations
- Registry permission abuse
- Startup program modification
- Persistence

#### AlwaysInstallElevated
- MSI installation elevation
- Privilege escalation
- System compromise

#### Kernel Exploits
- Windows kernel vulnerabilities
- Local privilege escalation
- System compromise

### Vertical Privilege Escalation
- Gaining higher privileges
- User to admin
- Limited to full access

### Horizontal Privilege Escalation
- Accessing other users' resources
- Same privilege level
- Data access

## Exploitation Tools

- **Metasploit**: Exploitation framework
- **sqlmap**: SQL injection tool
- **Burp Suite**: Web application security testing
- **OWASP ZAP**: Web application scanner
- **BeEF**: Browser exploitation framework
- **John the Ripper**: Password cracker
- **Hashcat**: Advanced password recovery
- **Hydra**: Network login cracker
- **Medusa**: Parallel login cracker

## Code Examples

### Python Examples
See the `examples/` directory for:
- `buffer_overflow_exploit.py` - Buffer overflow exploitation framework
- `payload_generator.py` - Generates various exploitation payloads

### Node.js Examples
See the `examples/nodejs/` directory for:
- `buffer_overflow_exploit.js` - Buffer overflow exploitation (Node.js)
- `payload_generator.js` - Payload generator (Node.js)

### Usage
```bash
# Python
python examples/buffer_overflow_exploit.py 192.168.1.100 9999
python examples/payload_generator.py reverse 192.168.1.100 4444

# Node.js
node examples/nodejs/buffer_overflow_exploit.js 192.168.1.100 9999
node examples/nodejs/payload_generator.js reverse 192.168.1.100 4444
```

## Best Practices

1. Always test exploits in isolated environments
2. Understand the vulnerability before exploiting
3. Use proof-of-concept exploits responsibly
4. Document exploitation steps
5. Verify impact and scope
6. Use appropriate tools for the task
7. Consider detection mechanisms
8. Plan post-exploitation activities

---

**Previous**: [04. Vulnerability Assessment](../04-vulnerability-assessment)  
**Next**: [06. Post-Exploitation](../06-post-exploitation)

